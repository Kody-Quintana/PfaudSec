\documentclass{article}
\usepackage{lastpage}           %-to identify last page
\usepackage{xspace}             %-to force add a space
\usepackage[abspath]{currfile}  %-to find path to this file
\usepackage{xstring,ifthen}     %-to manipulate strings
\usepackage{graphicx}           %-to add images
\usepackage{tikz}               %-to create Pfaudler logo
	\usetikzlibrary{shapes.geometric} %-for creating hexagon
\usepackage[linktoc=all,        %-for clickable links and pdf metadata
            colorlinks=true,
            linkcolor=black,
            urlcolor=black,
            citecolor=black,
            pdfauthor={Pfaudler Inc.},
            pdftitle={Data Book},
            pdfsubject={},
            pdfkeywords={},
            pdfproducer={},
            pdfcreator={}]{hyperref}

%-----Font configuration-----%
\usepackage{fontspec}
\setmainfont[
  Path          = ./,
  Ligatures     = TeX,
  UprightFont   = font/OTF/Pfaudler-Book.otf,
  BoldItalicFont= font/OTF/Pfaudler-BoldItalic.otf,
  BoldFont      = font/OTF/Pfaudler-Bold.otf,
  ItalicFont    = font/OTF/Pfaudler-BookItalic.otf
]{Pfaudler}
%----------------------------%



%-----Margin formatting-----%
\usepackage[letterpaper]{geometry}
\geometry{top=0.9in, bottom=0.9in, left=0.9in, right=0.9in}
%---------------------------%



%-----Pfaudler colorscheme-----%
\definecolor{pfblue}{RGB}{52,134,199}
\definecolor{pfgrey}{RGB}{125,125,130}
%------------------------------%



%--------------Pfaudler logo (invoke with \pflogo)---------------%
%--(Must be contained in one paragraph for use in the header)--%
\newcommand\pflogo{%
\begin{tikzpicture}
\node [right,scale=1,inner sep=1pt,outer sep=0pt, text=pfblue]
at (0,0) {\fontsize{10.8}{5}\selectfont{%
%
%--Strapline--%
Defining the Standard}};
%
\node [right,scale=1,inner sep=0pt,outer sep=0pt, text=pfgrey]
at (0,0.75) {\addfontfeature{LetterSpace=0.0}\fontsize{30}{0}\selectfont{%
%
%--Manually kerned Main text--%
\textbf{%
P{\kern 0.5pt}%
f{\kern-0.5pt}%
a{\kern-1.5pt}%
u{\kern-1pt}%
d{\kern-1.5pt}%
l{\kern-1.0pt}%
e{\kern-0.7pt}%
r}%
}};
%
%--Pf hexagon--%
\path (4.70,1.27) node [regular polygon,
		regular polygon sides=6,
		rounded corners=1.8pt,
		fill,
		inner sep=1.7pt,
		fill = pfblue,
		text = white] 
(hexagon){\large\textbf{Pf}};
\end{tikzpicture}}
%----------------------------------------------------------------%



%---------------------------------Header Formatting---------------------------------%
\usepackage{fancyhdr}
\pagestyle{fancy}

%--First page header style--%
\fancypagestyle{style1}{
\fancyhf{}
\fancyhead[L]{\pflogo}
\fancyhead[R]{
P.O. Box 23600\\
Rochester, NY 14692-3600\\
Telephone: 1-585-235-1000\\
Site: www.pfaudler.com}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}}

%--Embedded documents overlay header--%
\fancypagestyle{style2}{
\fancyhf{}
\fancyhead[C]{%
\textbf{Order Number: }\jobinfofill{mo},
\textbf{Serial Number: }\jobinfofill{serial},
\textbf{Customer: }\jobinfofill{customer},
\textbf{Equipment: }\jobinfofill{equipment}}
\fancyfoot[R]{\textbf{Data Book: }\thepage\xspace of \pageref{LastPage}}
\renewcommand{\headrulewidth}{1pt}}
%-----------------------------------------------------------------------------------%



%----------Table of Contents Formatting----------%
%--(compiler must be ran twice to update TOC--%
\usepackage{titletoc}

%--section toc format--%
\titlecontents{section}
[1.5em]
{}
{\contentslabel{2.3em}}
{}
{\titlerule*[0.7pc]{.}\contentspage}

%--subsecion toc format--%
\titlecontents{subsection}
[4em]
{\hangindent1em}
{\contentslabel{2.3em}}
{}
{\titlerule*[0.7pc]{.}\contentspage}
%------------------------------------------------%



%-----External job info (jobinfo.dat)-----%
\usepackage{datatool}
\DTLsetseparator{ = } %-Spaces must be included
\DTLloaddb[noheader, keys={thekey,thevalue}]{jobinfo}{jobinfo.dat}
\newcommand{\jobinfofill}[1]{\DTLfetch{jobinfo}{thekey}{#1}{thevalue}}
%-----------------------------------------%



\setlength{\parskip}{1em}
\setlength\headheight{58pt}



%-------------Page embedder-------------%
\usepackage{pdfpages}

%--newcommand for sections--%
\newcommand\addsection[1]{\addtocounter{section}{1}\phantomsection\addcontentsline{toc}{section}{{\arabic{section}.\xspace } {#1}}}

%--newcommand for subsections--%
\newcommand\addpage[1]{%
	\StrBefore[1]{#1}{.}[\temp] %-Display name must be stored in \temp because of expansion behavior in \includepdf
	\includepdf[pages=-,pagecommand=\newpage\phantomsection\addcontentsline{toc}{subsection}{\temp}]{#1}}
%---------------------------------------%



%%%%%                                                                                                       %%%%%
%%%%%  ____                   _             _____                                                      _    %%%%%
%%%%% |  _ \                 (_)           |  __ \                                                    | |   %%%%%
%%%%% | |_) |   ___    __ _   _   _ __     | |  | |   ___     ___   _   _   _ __ ___     ___   _ __   | |_  %%%%%
%%%%% |  _ <   / _ \  / _` | | | | '_ \    | |  | |  / _ \   / __| | | | | | '_ ` _ \   / _ \ | '_ \  | __| %%%%%
%%%%% | |_) | |  __/ | (_| | | | | | | |   | |__| | | (_) | | (__  | |_| | | | | | | | |  __/ | | | | | |_  %%%%%
%%%%% |____/   \___|  \__, | |_| |_| |_|   |_____/   \___/   \___|  \__,_| |_| |_| |_|  \___| |_| |_|  \__| %%%%%
%%%%%                  __/ |                                                                                %%%%%
%%%%%                 |___/                                                                                 %%%%%



\begin{document}
\begin{flushleft}
\pagestyle{style1}

\hspace{-2pt}\fontsize{60}{60}\selectfont\textbf{Data Book}

\LARGE
\begin{tabular}{@{}lr}
\noindent
\textbf{Order Number: }&\jobinfofill{mo}\\
\textbf{Serial Number: }&\jobinfofill{serial}\\
\textbf{Customer: }&\jobinfofill{customer}\\
\textbf{Equipment: }&\jobinfofill{equipment}
\end{tabular}

\vspace{12pt}
\large
This document contains the following for the \jobinfofill{equipment} in reference:

%-----Table of Contents-----%
\startcontents[section]
\begin{center}
\setlength{\parskip}{0.5em}
\printcontents[section]{}{1}{}
\setlength{\parskip}{1em}
\end{center}
%---------------------------%


If you would like to request additional documents, please feel free to contact us.

\null\hfill
\begin{tabular}{l@{}}
  Sincerely, \\[5\normalbaselineskip]
  Name J.\ Lname
\end{tabular}



%-----Begin Embedded Documents-----%
\newpage
\pagestyle{style2}
\setlength\headheight{12pt}
\include{embedlist} %Embeds documents listed in embedlist.tex
%----------------------------------%



\end{flushleft}
\end{document}
