\documentclass[14pt]{article}

\usepackage{datatool}
\DTLsetseparator{ = }% Set the separator between the columns. Could be
% anything you like. Whitespaces are not trimmed, so you have to set
%them as part of the separator.
%\usepackage[OT1]{fontenc} 
\usepackage{fontspec}
%\setmainfont{Pfaudler}
\setmainfont[
  Path          = ./,
  Ligatures     = TeX,
  UprightFont   = font/TTF/Pfaudler-Book.ttf,
  BoldItalicFont= font/TTF/Pfaudler-BoldItalic.ttf,
  BoldFont      = font/TTF/Pfaudler-Bold.ttf,
  ItalicFont    = font/TTF/Pfaudler-BookItalic.ttf
]{Pfaudler}
%\newfontfamily\CalibriLight[
%  Path          = \currfileabsdir,
%  Ligatures     = TeX,
%  UprightFont   = calibri/Calibri_Light.ttf,
%  ItalicFont    = calibri/Calibri_Light_Italic.ttf
%]{Calibri_Light}
%\usepackage[]{minted}
%\usepackage[utf8]{inputenc}
%\usepackage[english]{babel}
\usepackage{pdfpages}
\usepackage{tcolorbox}
\usepackage[letterpaper]{geometry}

\geometry{top=0.9in, bottom=0.9in, left=0.9in, right=0.9in}
%\usepackage{times}
\usepackage{titlesec}
\usepackage{fancyhdr}
\pagestyle{fancy}

\fancypagestyle{style1}{
\fancyhf{}
\fancyhead[R]{\includegraphics[width=5cm]{logo.png}}
\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
}

\fancypagestyle{style2}{
\fancyhf{}
\fancyhead[C]{%
\textbf{MO Number: }\jobinfofill{mo},
\textbf{Serial Number: }\jobinfofill{serial},
\textbf{Customer: }\jobinfofill{customer},
\textbf{Equipment: }\jobinfofill{equipment}}

\fancyfoot[R]{\thepage}
\renewcommand{\headrulewidth}{1pt}
}

\usepackage[abspath]{currfile}
\usepackage{xstring,ifthen}
\usepackage{graphicx}
\usepackage{titletoc}
\setlength\headheight{57pt}
%\fancyhf{} % sets both header and footer to nothing
%\renewcommand{\headrulewidth}{0pt}






\titlecontents{section}
[1em]
{\hangindent1em}
{\contentslabel{2.3em}}
{}
{\titlerule*[0.7pc]{.}\contentspage}

\usepackage[linktoc=all,
            colorlinks=true,
            linkcolor=black,
            urlcolor=black,
            citecolor=black,
            pdfauthor={},
            pdftitle={},
            pdfsubject={},
            pdfkeywords={},
            pdfproducer={},
            pdfcreator={}]{hyperref}
\usepackage{changepage}

\setcounter{tocdepth}{2}
\setcounter{secnumdepth}{1}

%-----data file variable maker-----%
\DTLloaddb[noheader, keys={thekey,thevalue}]{jobinfo}{jobinfo.dat}
\newcommand{\jobinfofill}[1]{\DTLfetch{jobinfo}{thekey}{#1}{thevalue}}
%----------------------------------%



%\setlength{\baselineskip}{2em}
%\setlength{\parindent}{4em}
\setlength{\parskip}{2em}

\titleformat{\section}{}{}{0pt}{}
%\titleformat{\section}
%  {}{}{1em}{}

%-----Page embedder-----%
\newcommand\addpage[1]{%
	\StrBefore[1]{#1}{.}[\temp]
	\includepdf[pages=-,pagecommand=\newpage\phantomsection\addcontentsline{toc}{section}{\temp}]{#1}}
	%\phantomsection\newpage\addcontentsline{toc}{section}{\temp}
%-----------------------%



% this is for the folder method \StrBefore{\monum}{/}\\


\begin{document}
\begin{flushleft}


\pagestyle{style1}
\vspace{0cm}\hspace{-5pt}{\fontsize{60}{60}\selectfont Data Book}

%-----upper left header logo-----%

%\begin{adjustwidth}{0.5cm}{0.5cm}
\begin{minipage}{0.6\textwidth}
\LARGE
\vspace{0cm}\hspace{-5pt}\begin{tabular}{lr}
\noindent
\textbf{MO Number: }&\jobinfofill{mo}\\
\textbf{Serial Number: }&\jobinfofill{serial}\\
\textbf{Customer: }&\jobinfofill{customer}\\
\textbf{Equipment: }&\jobinfofill{equipment}
\end{tabular}
\end{minipage}

%Pfaudler Inc.\\
%P.O. Box 23600\\
%Rochester, NY 14692-3600\\
%1-585-235-1000\\
%www.pfaudler.com

%---------------------------------%




%-----Upper folder name finder-----%
\newcounter{columnnumber}
\newcommand{\getcolumnnumber}[1]
{
	\IfSubStr{#1}{/}
		{\StrCount{#1}{/}[\tmp]\setcounter{columnnumber}{\tmp}\stepcounter{columnnumber}}
			{\setcounter{columnnumber}{1}}
\addtocounter{columnnumber}{-2}
}
\getcolumnnumber{\currfileabsdir}
\StrBehind[\thecolumnnumber]{\currfileabsdir}{/}[\monum]
%----------------------------------%







%\LARGE
%\hspace{-5pt}\begin{tabular}{lr}
%\textbf{MO Number: }&\jobinfofill{mo}\\
%% this is for the folder method \StrBefore{\monum}{/}\\
%\textbf{Serial Number: }&\jobinfofill{serial}\\
%\textbf{Customer: }&\jobinfofill{customer}\\
%\textbf{Equipment: }&\jobinfofill{equipment}
%\end{tabular}


\Large
Dear Sirs:

We are sending the Data Book of the equipment in reference containing:


\startcontents[section]
\begin{center}
%\begin{minipage}{0.9\textwidth}
\printcontents[section]{}{1}{}
%\end{minipage}
\end{center}
%\begin{itemize}
%\item drawing
%\item nameplate copy
%\item quality control reports
%\item test materials
%\end{itemize}

In case you need more documents, please feel free to contact us,

\Large
\null\hfill
\begin{tabular}{l@{}}
  Sincerely, \\[5\normalbaselineskip]
  Name J.\ Lname
\end{tabular}
\newpage
\pagestyle{style2}
\setlength\headheight{12pt}
\addpage{testinsert.pdf}
\addpage{testinsert.pdf}
\addpage{testinsert.pdf}
\addpage{test2.pdf}

%\end{adjustwidth}
\end{flushleft}
\end{document}
